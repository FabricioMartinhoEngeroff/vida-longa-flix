<div class="backdrop" [class.visivel]="aberta" (click)="onFechar()">
  <div class="modal" [class.visivel]="aberta" (click)="$event.stopPropagation()">
    
    <button class="btn-fechar" (click)="onFechar()" type="button">
      <mat-icon>close</mat-icon>
    </button>

    <h2 class="titulo">Meu Perfil</h2>

    <form [formGroup]="form" (ngSubmit)="onSalvar()">
      
      <!-- Email + Nome (readonly) -->
      <div class="linha-campos">
        <app-campo-formulario
          label="E-mail"
          placeholder="seu@email.com"
          formControlName="email"
          type="email"
          icon="mail"
          [maxlength]="254"
          [showCounter]="true"
          [error]="erroCampo('email')"
        ></app-campo-formulario>

        <app-campo-formulario
          label="Nome completo"
          placeholder="Digite seu nome"
          formControlName="nome"
          type="text"
          icon="user"
          [maxlength]="100"
          [showCounter]="true"
          [error]="erroCampo('nome')"
        ></app-campo-formulario>
      </div>

      <!-- CPF + Telefone -->
      <div class="linha-campos">
        <app-campo-formulario
          label="CPF"
          placeholder="000.000.000-00"
          formControlName="cpf"
          icon="id"
          mascara="cpf"
          [maxlength]="14"
          [showCounter]="true"
          [error]="erroCampo('cpf')"
        ></app-campo-formulario>

        <app-campo-formulario
          label="Telefone"
          placeholder="(00) 00000-0000"
          formControlName="telefone"
          type="tel"
          icon="phone"
          mascara="telefone"
          [maxlength]="15"
          [showCounter]="false"
          [error]="erroCampo('telefone')"
        ></app-campo-formulario>
      </div>

      <div formGroupName="endereco">
        
        <!-- Rua + Número -->
        <div class="linha-campos">
          <app-campo-formulario
            label="Rua"
            placeholder="Digite o nome da rua"
            formControlName="rua"
            type="text"
            icon="pin"
            [maxlength]="200"
            [showCounter]="true"
            [error]="erroCampo('endereco.rua')"
          ></app-campo-formulario>

          <app-campo-formulario
            label="Número"
            placeholder="Digite o número"
            formControlName="numero"
            type="text"
            icon="hash"
            [maxlength]="10"
            [showCounter]="false"
            [error]="erroCampo('endereco.numero')"
          ></app-campo-formulario>
        </div>

        <!-- Bairro + Cidade -->
        <div class="linha-campos">
          <app-campo-formulario
            label="Bairro"
            placeholder="Digite o bairro"
            formControlName="bairro"
            type="text"
            icon="home"
            [maxlength]="100"
            [showCounter]="true"
            [error]="erroCampo('endereco.bairro')"
          ></app-campo-formulario>

          <app-campo-formulario
            label="Cidade"
            placeholder="Digite a cidade"
            formControlName="cidade"
            type="text"
            icon="city"
            [maxlength]="100"
            [showCounter]="true"
            [error]="erroCampo('endereco.cidade')"
          ></app-campo-formulario>
        </div>

        <!-- Estado + CEP -->
        <div class="linha-campos">
          <app-campo-formulario
            label="Estado"
            placeholder="UF"
            formControlName="estado"
            type="text"
            icon="globe"
            [maxlength]="2"
            [showCounter]="false"
            [error]="erroCampo('endereco.estado')"
          ></app-campo-formulario>

          <app-campo-formulario
            label="CEP"
            placeholder="00000-000"
            formControlName="cep"
            icon="hash"
            mascara="cep"
            [maxlength]="9"
            [showCounter]="true"
            [error]="erroCampo('endereco.cep')"
          ></app-campo-formulario>
        </div>
      </div>

      <!-- Botão Mudar Senha -->
      <button type="button" class="btn-mudar-senha" (click)="onAbrirMudarSenha()">
        <mat-icon>lock</mat-icon>
        <span>Mudar Senha</span>
      </button>

      <!-- Botões -->
      <div class="botoes">
        <button class="btn-cancelar" type="button" (click)="onFechar()">
          Cancelar
        </button>

        <button class="btn-salvar" type="submit">
          Salvar Alterações
        </button>
      </div>
    </form>
  </div>
</div>